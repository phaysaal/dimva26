diff --git a/cttoolchain/tools.py b/cttoolchain/tools.py
index 84b44832..17059ad1 100644
--- a/cttoolchain/tools.py
+++ b/cttoolchain/tools.py
@@ -889,16 +889,27 @@ def generic_create_tests_folders(list_of_path_to_folders):
 
 # Run Binsec
 def run_binsec(executable_file, cfg_file, stats_files, output_file, depth, **kwargs):
-    command = f'''binsec -sse -checkct -checkct-features memory-access,control-flow,divisor,dividend,multiplication
-     -sse-script {cfg_file} -sse-depth  {depth} -sse-self-written-enum 1 -checkct-stats-file {stats_files}'''
+    binsec_command = f'''binsec -sse -checkct -checkct-features memory-access,control-flow,divisor,dividend,multiplication -sse-script {cfg_file} -sse-depth  1000000000 -sse-self-written-enum 1 -checkct-stats-file {stats_files}'''
+    timeout_value = 2000
     if kwargs:
         for k, value in kwargs.items():
             if 'sse_timeout' in k:
-                command += f' -sse-timeout {value}'
-            elif 'solver_timeout' in k:
-                command += f' -fml-solver-timeout {value}'
-    command += f' {executable_file}'
+                binsec_command += f' -sse-timeout {value}'
+                timeout_value = value
+            binsec_command += f' -fml-solver-timeout 1800'
+    binsec_command += f' {executable_file}'
+    secret_byte = 1
+    
+    if '_SSK' in executable_file:
+        secret_byte = 3
+    elif '_ESK' in executable_file:
+        sec_bytes = [('24_5_16_4', 36848), ('24_5_16_5', 60048), ('25_8_16_3', 39576), ('29_6_16_5', 100398), ('37_17_16_2', 91440), ('37_8_16_4', 133040), ('49_11_16_3', 177060), ('56_25_16_2', 300848), ('60_10_16_4', 395248), ('66_15_16_3', 435423), ('75_33_16_2', 704532)]
+        for esk, sb in sec_bytes:
+            if esk in executable_file:
+                secret_byte = sb - 31 # int((sb-32)/8)
+    command = f"binsec-utils -w 1 --objdump-parser core auto-pqc1 -t {timeout_value} --run-timeout-cap {timeout_value} --keep-ct-secret --replace-function calloc cfree randombytes --ct-secret-byte {secret_byte} --replace-opcode  0f05 660f2ee2 660f2fc2 660f38dcd0 660f38dcd1 660f38dcd8 660f38dcd9 660f38dce0 660f38dce1 660f38dce8 660f38dce9 660f38dcf0 660f38dcf1 660f38dcf4 660f38dcf5 660f38dcf8 660f38dcf9 660f38dd542400 660f38dd5c2410 660f38dd642420 660f38dd6c2430 660f38dd742440 660f38dd7c2450 660f38ddc4 660f38ddd0 660f38ddd1 660f38ddd3 660f38ddd4 660f38ddd7 660f38ddd8 660f38ddd9 660f38dde0 660f38dde1 660f38dde8 660f38dde9 660f38ddf0 660f38ddf5 660f38ddf8 66410f38ddd2 66410f38dddb 66410f38dde4 66410f38dded 66410f38ddf6 66410f38ddff 66440f38dcc0 66440f38dcc1 66440f38dcc8 66440f38dcc9 66440f38ddc0 66440f38ddc1 66440f38ddc8 66450f38ddca c44201dced c44201dcfa c44201dcfc c44209dcf0 c44209dcf1 c44209dcf3 c44211dce4 c44219dcdb c44221dcd2 c44229dcc9 c44231dcc0 c44231dcc8 c44231dcca c44231dce2 c44231ddca c4423902c0 c4423902c1 c44239dcc2 c44239ddc2 c44261dcf1 c44261dcf2 c44261dcf5 c44379dfd404 c44379dff210 c46201dc7c2440 c46201dc7c2450 c46201dcbc2400010000 c46201dcbc2410010000 c46201dcbc2430020000 c46201dcbc2460010000 c46201dcbc2480000000 c46201dcbc2490000000 c46201dcbc24a0010000 c46201dcbc24c0000000 c46201dcbc24d0000000 c46201dcbc24f0010000 c46201dcf9 c46201dcfd c46201dcff c46201dd7c2420 c46201dd7c2430 c46201ddbc2440020000 c46209dc742460 c46209dc742470 c46209dcb42410020000 c46209dcb42420010000 c46209dcb42430010000 c46209dcb42440010000 c46209dcb42480010000 c46209dcb424a0000000 c46209dcb424b0000000 c46209dcb424b0010000 c46209dcb424d0010000 c46209dcb424e0000000 c46209dcb424f0000000 c46209dcf3 c46209dcf4 c46209dcf6 c46209dcf7 c46211dc6850 c46211dca810010000 c46211dca870010000 c46211dca8b0000000 c46211dca8b0010000 c46219dc6030 c46219dc6670 c46219dca0f0000000 c46219dca630010000 c46219dca670010000 c46219dca6b0000000 c46219dca6b0010000 c46221dc5a70 c46221dc5e30 c46221dc9a30010000 c46221dc9a70010000 c46221dc9ab0000000 c46221dc9ab0010000 c46221dc9ef0000000 c46229dc5170 c46229dc5230 c46229dc9130010000 c46229dc9170010000 c46229dc91b0000000 c46229dc91b0010000 c46229dc92f0000000 c46231dc4e50 c46231dc8850010000 c46231dc8890000000 c46231dc8a90010000 c46231dc8ac0010000 c46231dc8e10010000 c46231dc8ed0000000 c46239dc4250 c46239dc442450 c46239dc8210010000 c46239dc82d0000000 c46239dc842410010000 c46239dc842490000000 c46239dc8424d0000000 c46239dc8650010000 c46239dc8690000000 c46239dc8690010000 c46239dcc7 c46239dd82d0010000 c462558c859031ffff c4625d8ebdd0feffff c46261dcf7 c46261dd3424 c462650480c0020000 c4626d0480e0020000 c462750480a0020000 c462bbf5c0 c462bbf5c2 c46379dfe300 c46379dfe336 c46379dfe800 c46379dfea4d c46379dff780 c4825d8c0410 c4c209dcc9 c4c209dccc c4c209dcd0 c4c209dcd5 c4c24102f8 c4c241dcfa c4c241ddfa c4c249dcf4 c4c251dceb c4c259dcda c4c259dce2 c4c25d8c4040 c4c261dcd8 c4c261dcd9 c4c261dcda c4c261dcdb c4c261dcdc c4c261dcdd c4c269dccc c4c269dcd0 c4c269dcd1 c4c269dcd2 c4c269dcd3 c4c269dcd4 c4c269dcd5 c4c271dcc8 c4c271dcc9 c4c271dcca c4c271dccb c4c271dccc c4c271dccd c4c271dccf c4c271dcd8 c4c271dcdb c4c271dce3 c4c271ddce c4c279dcc0 c4c279dcc1 c4c279dcc2 c4c279dcc3 c4c279dcc4 c4c279dcc5 c4c279ddc2 c4c279ddc6 c4c27d8c00 c4c27d8c12 c4c2ebf5d1 c4c2f3f5c9 c4c2fbf5c1 c4c379dfc320 c4c379dfc840 c4c379dfc920 c4c379dfca10 c4c379dfcb08 c4c379dfcc04 c4c379dfcd02 c4c379dfce01 c4c379dfcf01 c4c379dfd000 c4c379dfd010 c4c379dfd040 c4c379dfd04d c4c379dfd100 c4c379dfd108 c4c379dfd200 c4c379dfd204 c4c379dfd208 c4c379dfd300 c4c379dfd302 c4c379dfd400 c4c379dfd410 c4c379dfd501 c4c379dfd800 c4c379dfd836 c4c379dfd8d8 c4c379dfd908 c4c379dfd94d c4c379dfd96c c4c379dfd9ab c4c379dfda00 c4c379dfda40 c4c379dfdaab c4c379dfdb08 c4c379dfdb10 c4c379dfdbd8 c4c379dfdc00 c4c379dfdc6c c4c379dfdd00 c4c379dfdd20 c4c379dfde01 c4c379dfdf02 c4c379dfe120 c4c379dfed02 c4e209dcce c4e239dc7130 c4e239dcff c4e24102ff c4e241dc7950 c4e241dc7c2460 c4e241dc7f50 c4e241dcb910010000 c4e241dcb990010000 c4e241dcb9d0000000 c4e241dcba50010000 c4e241dcba90000000 c4e241dcbc2420010000 c4e241dcbc24a0000000 c4e241dcbc24e0000000 c4e241dcbf10010000 c4e241dcbf50010000 c4e241dcbf90000000 c4e241dcbf90010000 c4e241dcbfd0000000 c4e241dcf6 c4e241ddb9d0010000 c4e2458ead90feffff c4e24902f4 c4e24902f6 c4e249dc7070 c4e249dc742440 c4e249dc7650 c4e249dcb030010000 c4e249dcb090010000 c4e249dcb0d0000000 c4e249dcb150010000 c4e249dcb190000000 c4e249dcb1f0000000 c4e249dcb42400010000 c4e249dcb42480000000 c4e249dcb424c0000000 c4e249dcb610010000 c4e249dcb650010000 c4e249dcb690000000 c4e249dcb690010000 c4e249dcb6d0000000 c4e249dced c4e249ddb0d0010000 c4e24d8e95b031ffff c4e25102ec c4e25102ed c4e251dc6a40 c4e251dc6a60 c4e251dc6f30 c4e251dc6f70 c4e251dcaa00010000 c4e251dcaa20010000 c4e251dcaa40010000 c4e251dcaa60010000 c4e251dcaa80000000 c4e251dcaa80010000 c4e251dcaaa0000000 c4e251dcaaa0010000 c4e251dcaac0000000 c4e251dcaae0000000 c4e251dcaf30010000 c4e251dcaf70010000 c4e251dcafb0000000 c4e251dcafb0010000 c4e251dcaff0000000 c4e251dd1424 c4e251dda8e0010000 c4e2558c9510feffff c4e2558c95d0fdffff c4e25902e4 c4e25902e5 c4e25902e6 c4e25902e7 c4e259dc6040 c4e259dc6060 c4e259dc6220 c4e259dc6240 c4e259dc6260 c4e259dc6630 c4e259dc6670 c4e259dc6750 c4e259dca000010000 c4e259dca020010000 c4e259dca040010000 c4e259dca060010000 c4e259dca080000000 c4e259dca080010000 c4e259dca0a0000000 c4e259dca0a0010000 c4e259dca0c0000000 c4e259dca0e0000000 c4e259dca200010000 c4e259dca220010000 c4e259dca240010000 c4e259dca280000000 c4e259dca280010000 c4e259dca2a0010000 c4e259dca2c0000000 c4e259dca2e0000000 c4e259dca42400010000 c4e259dca42440010000 c4e259dca42480000000 c4e259dca424c0000000 c4e259dca630010000 c4e259dca670010000 c4e259dca6b0000000 c4e259dca6b0010000 c4e259dca6f0000000 c4e259dca710010000 c4e259dca750010000 c4e259dca790000000 c4e259dca790010000 c4e259dca7d0000000 c4e259dca8c0010000 c4e259dcdd c4e259dce2 c4e259dda6d0010000 c4e259dda7d0010000 c4e25d8ca510feffff c4e25d8ca550feffff c4e261dc5820 c4e261dc5830 c4e261dc5840 c4e261dc5850 c4e261dc5860 c4e261dc5870 c4e261dc5e40 c4e261dc5e60 c4e261dc5f30 c4e261dc5f40 c4e261dc5f60 c4e261dc5f70 c4e261dc9880000000 c4e261dc9890000000 c4e261dc98a0000000 c4e261dc9e00010000 c4e261dc9e20010000 c4e261dc9e40010000 c4e261dc9e60010000 c4e261dc9e80000000 c4e261dc9e80010000 c4e261dc9ea0000000 c4e261dc9ea0010000 c4e261dc9ec0000000 c4e261dc9ec0010000 c4e261dc9ee0000000 c4e261dc9f00010000 c4e261dc9f20010000 c4e261dc9f30010000 c4e261dc9f40010000 c4e261dc9f60010000 c4e261dc9f70010000 c4e261dc9f80000000 c4e261dc9f80010000 c4e261dc9fa0000000 c4e261dc9fa0010000 c4e261dc9fb0000000 c4e261dc9fb0010000 c4e261dc9fc0000000 c4e261dc9fc0010000 c4e261dc9fe0000000 c4e261dc9ff0000000 c4e261dcdd c4e261dcde c4e261dcdf c4e261dd1c24 c4e261dd98b0000000 c4e261dd9ee0010000 c4e261dd9fe0010000 c4e261dddc c4e265046820 c4e265049880030000 c4e26504a020030000 c4e26504a040010000 c4e26504a080000000 c4e26504a0a0010000 c4e26504b0e0000000 c4e26504b800020000 c4e26504b860020000 c4e2658e8550feffff c4e26902c9 c4e269dc5140 c4e269dc5160 c4e269dc5620 c4e269dc5630 c4e269dc5640 c4e269dc5650 c4e269dc5660 c4e269dc5670 c4e269dc9100010000 c4e269dc9120010000 c4e269dc9140010000 c4e269dc9160010000 c4e269dc9180000000 c4e269dc9180010000 c4e269dc91a0000000 c4e269dc91a0010000 c4e269dc91c0000000 c4e269dc91c0010000 c4e269dc91e0000000 c4e269dc9680000000 c4e269dc9690000000 c4e269dc96a0000000 c4e269dccf c4e269dcd5 c4e269dcd6 c4e269dcd7 c4e269dd1424 c4e269dd4c2420 c4e269dd8ed0010000 c4e269dd8fd0010000 c4e269dd91e0010000 c4e269dd96b0000000 c4e269ddd4 c4e26d046840 c4e26d0490a0030000 c4e26d04a040030000 c4e26d04a060010000 c4e26d04a0a0000000 c4e26d04a0c0010000 c4e26d04b000010000 c4e26d04b820020000 c4e26d04b880020000 c4e26d8c00 c4e26d8c50d0 c4e26d8ead90feffff c4e27102c9 c4e271dc4820 c4e271dc4830 c4e271dc4840 c4e271dc4850 c4e271dc4860 c4e271dc4870 c4e271dc4a20 c4e271dc4a30 c4e271dc4a40 c4e271dc4a50 c4e271dc4a60 c4e271dc4a70 c4e271dc4c2440 c4e271dc4c2460 c4e271dc4c2470 c4e271dc8880000000 c4e271dc8890000000 c4e271dc88a0000000 c4e271dc8a80000000 c4e271dc8a90000000 c4e271dc8aa0000000 c4e271dc8c2400010000 c4e271dc8c2420010000 c4e271dc8c2430010000 c4e271dc8c2480000000 c4e271dc8c24a0000000 c4e271dc8c24b0000000 c4e271dc8c24c0000000 c4e271dc8c24e0000000 c4e271dc8c24f0000000 c4e271dccb c4e271dccc c4e271dccd c4e271dcce c4e271dccf c4e271dcdd c4e271dce4 c4e271dce6 c4e271dced c4e271dcf6 c4e271dd0c24 c4e271dd4c2430 c4e271dd82e0010000 c4e271dd88b0000000 c4e271dd8ab0000000 c4e271ddca c4e271ddcc c4e2750420 c4e275046060 c4e275048860030000 c4e27504a000030000 c4e27504a020010000 c4e27504a080010000 c4e27504a0c0000000 c4e27504b840020000 c4e27504b8e0010000 c4e2758c00 c4e2758c02 c4e2758c48d0 c4e2758e01 c4e279dc4120 c4e279dc4130 c4e279dc4140 c4e279dc4150 c4e279dc4160 c4e279dc4170 c4e279dc4210 c4e279dc4220 c4e279dc4230 c4e279dc4240 c4e279dc4250 c4e279dc4260 c4e279dc4270 c4e279dc442410 c4e279dc442430 c4e279dc442440 c4e279dc442450 c4e279dc442460 c4e279dc442470 c4e279dc4620 c4e279dc4630 c4e279dc4640 c4e279dc4650 c4e279dc4660 c4e279dc4670 c4e279dc4720 c4e279dc4730 c4e279dc4740 c4e279dc4750 c4e279dc4760 c4e279dc4770 c4e279dc8180000000 c4e279dc8190000000 c4e279dc81a0000000 c4e279dc81b0000000 c4e279dc81c0000000 c4e279dc81d0000000 c4e279dc81e0000000 c4e279dc8210010000 c4e279dc8230010000 c4e279dc8250010000 c4e279dc8270010000 c4e279dc8280000000 c4e279dc8290000000 c4e279dc8290010000 c4e279dc82b0000000 c4e279dc82b0010000 c4e279dc82d0000000 c4e279dc82f0000000 c4e279dc842400010000 c4e279dc842400020000 c4e279dc842410010000 c4e279dc842420010000 c4e279dc842420020000 c4e279dc842430010000 c4e279dc842440010000 c4e279dc842450010000 c4e279dc842460010000 c4e279dc842470010000 c4e279dc842480000000 c4e279dc842480010000 c4e279dc842490000000 c4e279dc842490010000 c4e279dc8424a0000000 c4e279dc8424a0010000 c4e279dc8424b0000000 c4e279dc8424b0010000 c4e279dc8424c0000000 c4e279dc8424c0010000 c4e279dc8424d0000000 c4e279dc8424d0010000 c4e279dc8424e0000000 c4e279dc8424e0010000 c4e279dc8424f0000000 c4e279dc8600010000 c4e279dc8620010000 c4e279dc8640010000 c4e279dc8660010000 c4e279dc8680000000 c4e279dc8680010000 c4e279dc8690000000 c4e279dc86a0000000 c4e279dc86a0010000 c4e279dc86b0000000 c4e279dc86c0000000 c4e279dc86c0010000 c4e279dc86d0000000 c4e279dc86e0000000 c4e279dc8700010000 c4e279dc8720010000 c4e279dc8740010000 c4e279dc8760010000 c4e279dc8780000000 c4e279dc8780010000 c4e279dc8790000000 c4e279dc87a0000000 c4e279dc87a0010000 c4e279dc87b0000000 c4e279dc87c0000000 c4e279dc87c0010000 c4e279dc87d0000000 c4e279dc87e0000000 c4e279dcc1 c4e279dcc2 c4e279dcc3 c4e279dcc4 c4e279dcc5 c4e279dcc6 c4e279dcc7 c4e279dccd c4e279dccf c4e279dceb c4e279dd0424 c4e279dd81b0000000 c4e279dd82a0000000 c4e279dd842430010000 c4e279dd842450020000 c4e279dd86b0000000 c4e279dd86e0010000 c4e279dd87b0000000 c4e279dd87e0010000 c4e279ddc2 c4e279ddc4 c4e27d8c01 c4e27d8c10 c4e27d8c19 c4e27d8c48d0 c4e27d8c50d0 c4e2c3f5f8 c4e2c3f5f9 c4e2c3f5fa c4e2c3f5fb c4e2cbf5f0 c4e2cbf5f1 c4e2cbf5f2 c4e2cbf5f3 c4e2ebf5c0 c4e2ebf5c8 c4e2ebf5d0 c4e2ebf5f8 c4e2f3f5c8 c4e2f3f5ca c4e2fbf5c1 c4e2fbf5c2 c4e2fbf5c3 c4e379dfc000 c4e379dfc040 c4e379dfc200 c4e379dfc400 c4e379dfc420 c4e379dfc500 c4e379dfc510 c4e379dfc520 c4e379dfc600 c4e379dfc610 c4e379dfc620 c4e379dfc700 c4e379dfc720 c4e379dfca80 c4e379dfcb36 c4e379dfcc00 c4e379dfcc1b c4e379dfcc20 c4e379dfcc36 c4e379dfcd00 c4e379dfcd01 c4e379dfcd1b c4e379dfcd36 c4e379dfcd80 c4e379dfce08 c4e379dfce10 c4e379dfce1b c4e379dfce36 c4e379dfce40 c4e379dfce80 c4e379dfcf00 c4e379dfcf01 c4e379dfcf08 c4e379dfcf20 c4e379dfcf40 c4e379dfcf80 c4e379dfd000 c4e379dfd001 c4e379dfd002 c4e379dfd004 c4e379dfd008 c4e379dfd010 c4e379dfd01b c4e379dfd020 c4e379dfd036 c4e379dfd040 c4e379dfd080 c4e379dfd100 c4e379dfd101 c4e379dfd140 c4e379dfd200 c4e379dfd240 c4e379dfd300 c4e379dfd31b c4e379dfd320 c4e379dfd340 c4e379dfd34d c4e379dfd380 c4e379dfd3ab c4e379dfd400 c4e379dfd402 c4e379dfd404 c4e379dfd408 c4e379dfd410 c4e379dfd41b c4e379dfd420 c4e379dfd436 c4e379dfd440 c4e379dfd44d c4e379dfd4d8 c4e379dfd500 c4e379dfd502 c4e379dfd504 c4e379dfd508 c4e379dfd510 c4e379dfd51b c4e379dfd520 c4e379dfd536 c4e379dfd540 c4e379dfd56c c4e379dfd580 c4e379dfd5ab c4e379dfd600 c4e379dfd602 c4e379dfd604 c4e379dfd608 c4e379dfd610 c4e379dfd61b c4e379dfd620 c4e379dfd640 c4e379dfd680 c4e379dfd700 c4e379dfd702 c4e379dfd704 c4e379dfd708 c4e379dfd710 c4e379dfd71b c4e379dfd720 c4e379dfd740 c4e379dfd780 c4e379dfd7d8 c4e379dfd800 c4e379dfd801 c4e379dfd802 c4e379dfd808 c4e379dfd81b c4e379dfd820 c4e379dfd836 c4e379dfd880 c4e379dfd900 c4e379dfd901 c4e379dfd902 c4e379dfd904 c4e379dfd908 c4e379dfd910 c4e379dfd91b c4e379dfd920 c4e379dfd936 c4e379dfd940 c4e379dfd94d c4e379dfd96c c4e379dfd980 c4e379dfd9ab c4e379dfd9d8 c4e379dfda01 c4e379dfda40 c4e379dfda80 c4e379dfdb00 c4e379dfdb20 c4e379dfdc00 c4e379dfdc10 c4e379dfdc1b c4e379dfdc20 c4e379dfdc36 c4e379dfdc40 c4e379dfdc4d c4e379dfdd00 c4e379dfdd04 c4e379dfdd10 c4e379dfdd1b c4e379dfdd36 c4e379dfdd40 c4e379dfdd80 c4e379dfde00 c4e379dfde04 c4e379dfde1b c4e379dfde40 c4e379dfde80 c4e379dfdeab c4e379dfdf00 c4e379dfdf10 c4e379dfdf20 c4e379dfdf40 c4e379dfdf80 c4e379dfdfd8 c4e379dfe000 c4e379dfe001 c4e379dfe008 c4e379dfe01b c4e379dfe036 c4e379dfe040 c4e379dfe06c c4e379dfe080 c4e379dfe0ab c4e379dfe0d8 c4e379dfe100 c4e379dfe102 c4e379dfe110 c4e379dfe14d c4e379dfe16c c4e379dfe180 c4e379dfe200 c4e379dfe204 c4e379dfe21b c4e379dfe220 c4e379dfe240 c4e379dfe2d8 c4e379dfe31b c4e379dfe380 c4e379dfe440 c4e379dfe500 c4e379dfe51b c4e379dfe520 c4e379dfe536 c4e379dfe5ab c4e379dfe600 c4e379dfe608 c4e379dfe680 c4e379dfe700 c4e379dfe736 c4e379dfe76c c4e379dfe780 c4e379dfe7ab c4e379dfe7d8 c4e379dfe84d c4e379dfe901 c4e379dfea00 c4e379dfea08 c4e379dff508 c53df5c0 c53df5c8 c53df5d0 c545f5c0 c545f5c8 c55df5c0 c5c5f5f8 c5cdf5f0 c5cdf5f8 c5d5f5e8 c5d5f5f0 c5ddf5e0 c5ddf5e8 c5ddf5f0 c5ddf5f8 c5e5f5d8 c5edf5d0 c5f5f5c8 f20f58059da10100 f20f58d4 f20f59c2 f20f5cc2 f20f5ec1 f20fc2e206 f2480f2ac0 f2480f2ad0 f2480f2cc0 f2490f2ac6 f4 -r"
     cmd_args_lst = command.split()
+    cmd_args_lst.append(binsec_command)
     with open(output_file, "w") as file:
         execution = Popen(cmd_args_lst, universal_newlines=True, stdout=file, stderr=file)
         execution.communicate()
